(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();const r=[{id:"p1",name:"상품1",val:1e4,stock:50},{id:"p2",name:"상품2",val:2e4,stock:30},{id:"p3",name:"상품3",val:3e4,stock:20},{id:"p4",name:"상품4",val:15e3,stock:0},{id:"p5",name:"상품5",val:25e3,stock:10}],v=.2,x=.3,b=3e4,g=(a,t)=>{setTimeout(()=>{setInterval(()=>{let s=a[Math.floor(Math.random()*a.length)];Math.random()<x&&s.stock>0&&(s.val=Math.round(s.val*(1-v)),alert("번개세일! "+s.name+"이(가) 20% 할인 중입니다!"),t())},b)},Math.random()*1e4)},I=(a,t,s)=>{setTimeout(()=>{setInterval(()=>{const i=t();if(!i)return;const n=a.find(o=>o.id!==i&&o.stock>0);n&&(alert(n.name+"은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!"),n.val=Math.round(n.val*.95),s())},6e4)},Math.random()*2e4)},c={totalAmt:0},e={sel:null,addBtn:null,cartDisp:null,sum:null,stockInfo:null};function k(a){a.innerHTML=`
    <div class="bg-gray-100 p-8">
      <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8">
        <h1 class="text-2xl font-bold mb-4">장바구니</h1>
      </div>
    </div>
  `;const s=a.firstElementChild.firstElementChild;e.cartDisp=document.createElement("div"),e.cartDisp.id="cart-items",s.appendChild(e.cartDisp),e.sum=document.createElement("div"),e.sum.id="cart-total",e.sum.className="text-xl font-bold my-4",s.appendChild(e.sum),e.sel=document.createElement("select"),e.sel.id="product-select",e.sel.className="border rounded p-2 mr-2",s.appendChild(e.sel),e.stockInfo=document.createElement("div"),e.stockInfo.id="stock-status",e.stockInfo.className="text-sm text-gray-500 mt-2",s.appendChild(e.stockInfo),e.addBtn=document.createElement("button"),e.addBtn.id="add-to-cart",e.addBtn.className="bg-blue-500 text-white px-4 py-2 rounded",e.addBtn.textContent="추가",s.appendChild(e.addBtn)}function f(){e.sel.innerHTML=r.map(a=>{const t=a.stock===0?"disabled":"";return`
      <option value=${a.id} ${t}>${a.name} - ${a.val}원</option>
    `}).join("")}function $(){e.bonusPts=Math.floor(c.totalAmt/1e3),e.sum.innerHTML+=`
    <span id="loyalty-points" class="text-blue-500 ml-2">(포인트: ${e.bonusPts})</span>
  `}function C(){const a=r.filter(t=>t.stock<5).map(t=>`<li>${t.name}: ${t.stock>0?`재고 부족 (${t.stock}개 남음)`:"품절"}</li>`);e.stockInfo.innerHTML=`<ul class="text-sm list-disc pl-4">${a.join("")}</ul>`}function h(){c.totalAmt=0,e.itemCnt=0;const a=e.cartDisp.children;let t=0;for(let n=0;n<a.length;n++){let o=r.find(m=>m.id===a[n].id);if(!o)continue;const l=parseInt(a[n].querySelector("span").textContent.split("x ")[1]);let d=0;e.itemCnt+=l,l>=10&&(o.id==="p1"?d=.1:o.id==="p2"?d=.15:o.id==="p3"?d=.2:o.id==="p4"?d=.05:o.id==="p5"&&(d=.25));const u=o.val*l;t+=u,c.totalAmt+=u*(1-d)}let s=0;if(e.itemCnt>=30){const n=c.totalAmt*.25,o=t-c.totalAmt;n>o?(c.totalAmt=t*(1-.25),s=.25):s=(t-c.totalAmt)/t}else s=(t-c.totalAmt)/t;new Date().getDay()===2&&(c.totalAmt*=1-.1,s=Math.max(s,.1));const i=Math.floor(c.totalAmt/1e3);e.sum.innerHTML=`
총액: ${Math.round(c.totalAmt)}원${s>0?`<span class="text-green-500 ml-2">
        (${(s*100).toFixed(1)}% 할인 적용)
      </span>`:`<span id="loyalty-points" class="text-blue-500 ml-2">(포인트: ${i})</span>`}
`,$(),C()}function M(){e.addBtn.addEventListener("click",()=>{const a=e.sel.value,t=r.find(i=>i.id===a);if(!t||t.stock<=0)return;const s=document.getElementById(t.id);if(s){const i=parseInt(s.querySelector("span").textContent.split("x ")[1])+1;if(i>t.stock){alert("재고가 부족합니다");return}s.querySelector("span").textContent=`${t.name} - ${t.val}원 x ${i}`,t.stock--}else{const i=document.createElement("div");i.id=t.id,i.className="flex justify-between items-center mb-2",i.innerHTML=`
        <span>${t.name} - ${t.val}원 x 1</span>
        <div>
          <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="-1">-</button>
          <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="1">+</button>
          <button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${t.id}">삭제</button>
        </div>
      `,e.cartDisp.appendChild(i),t.stock--}h()}),e.cartDisp.addEventListener("click",a=>{const t=a.target,s=t.classList.contains("quantity-change"),i=t.classList.contains("remove-item");if(!s&&!i)return;const n=t.dataset.productId,o=document.getElementById(n),l=r.find(m=>m.id===n),d=o.querySelector("span"),u=parseInt(d.textContent.split("x ")[1]);if(s){const m=parseInt(t.dataset.change),p=u+m,y=l.stock+u;if(p>y){alert("재고가 부족합니다.");return}p<=0?o.remove():d.innerHTML=`${l.name} - ${l.val}원 x ${p}`,l.stock-=m}i&&(l.stock+=u,o.remove()),h()})}let E;function A(){const a=document.getElementById("app");k(a),h(),f(),g(r,f),I(r,E,f),M()}A();
